<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Trang B√°n H√†ng C·ªßa Hi·∫øu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="HomePage.css">
    <script src="data/dataCom.js"></script>
    <script src="data/dataCf.js"></script>
    <script src="data/dataFan.js"></script>
    <script src="data/dataHutBui.js"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-dark navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="#">LTHSHOP</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <form class="d-flex ms-auto me-3" role="search" onsubmit="searchProducts(event)">
                <input class="form-control me-2 custom-search-input" type="search" id="search-input" placeholder="T√¨m ki·∫øm s·∫£n ph·∫©m" aria-label="Search">
                <button class="btn btn-outline-light custom-search-button" type="submit">T√¨m ki·∫øm</button>
            </form>
            <a href="GioHang.html" class="btn btn-warning">
                üõí Gi·ªè h√†ng (<span id="cart-count">0</span>)
            </a>
            <div id="auth-buttons" class="d-flex"></div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row">
            <aside class="col-lg-3 col-md-4 col-sm-12">
                <h4>ƒê·ªì Gia D·ª•ng</h4>
                <ul class="category-list">
                    <li><a href="NoiComDien.html">N·ªìi c∆°m ƒëi·ªán</a></li>
                    <li><a href="MayPhaCafe.html">M√°y pha c√† ph√™</a></li>
                    <li><a href="QuatMayLamMat.html">Qu·∫°t, M√°y l√†m m√°t</a></li>
                    <li><a href="MayHutBui.html">M√°y h√∫t b·ª•i</a></li>
                </ul>
            </aside>

            <section class="col-lg-9 col-md-8 col-sm-12">
                <div class="banner text-center">
                    Khuy·∫øn m√£i l√™n ƒë·∫øn 50% - Mua 1 t·∫∑ng 1
                    <br>
                </div>
                <div id="product-list" class="row"></div>
            </section>
        </div>
    </div>

    <script>
        function checkLoginStatus() {
            const authButtons = document.getElementById("auth-buttons");
            const storedUser = localStorage.getItem("loggedInUser");

            if (storedUser) {
                const userData = JSON.parse(storedUser);

                authButtons.innerHTML = `
            <div class="dropdown">
                <img src="image/avt.jpg" alt="Avatar" class="rounded-circle" width="60" height="60" role="button" data-bs-toggle="dropdown">
                <ul class="dropdown-menu dropdown-menu-end">
                    <li><a class="dropdown-item" href="#"">T√†i kho·∫£n c·ªßa t√¥i</a></li>
                    <li><a class="dropdown-item text-danger" href="#" onclick="logout()">ƒêƒÉng xu·∫•t</a></li>
                </ul>
            </div>
        `;
            } else {
                authButtons.innerHTML = `
            <a href="DangNhap.html" class="btn btn-outline-light me-2">ƒêƒÉng nh·∫≠p</a>
            <a href="DangKi.html" class="btn btn-light">ƒêƒÉng k√Ω</a>
        `;
            }
        }

        function logout() {
            localStorage.removeItem("loggedInUser");
            window.location.reload();
        }

        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem("cart")) || [];
            document.getElementById("cart-count").innerText = cart.length;
        }

        function loadProducts() {
            const container = document.getElementById("product-list");
            let html = "";
            let allProducts = [];

            function collectProducts(data) {
                for (const category in data) {
                    allProducts = allProducts.concat(data[category]);
                }
            }

            // G·ªôp d·ªØ li·ªáu t·ª´ c√°c ngu·ªìn
            collectProducts(dataCom);
            collectProducts(dataCf);
            collectProducts(dataFan);

            // Tr·ªôn ng·∫´u nhi√™n v√† l·∫•y 6 s·∫£n ph·∫©m
            const shuffled = allProducts.sort(() => 0.5 - Math.random());
            const selected = shuffled.slice(0, 6);

            // Render ra HTML
            selected.forEach(p => {
                html += `
        <div class="col-md-4 mb-4">
            <div class="card h-100">
                <img src="${p.img}" class="card-img-top" alt="${p.name}">
                <div class="card-body d-flex flex-column">
                    <h5 class="card-title">${p.name}</h5>
                    <p class="card-text text-danger fw-bold">${p.price}</p>
                    <button class="btn btn-primary mt-auto" onclick="addToCart('${p.name}', '${p.price}', '${p.img}')">Th√™m v√†o gi·ªè h√†ng</button>
                </div>
            </div>
        </div>`;
            });

            container.innerHTML = html;
        }


        function addToCart(name, price, image) {
            const storedUser = localStorage.getItem("loggedInUser");

            if (!storedUser) {
                alert("B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng!");
                // Ho·∫∑c chuy·ªÉn h∆∞·ªõng t·ª± ƒë·ªông:
                // window.location.href = "DangNhap.html";
                return;
            }

            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            let product = cart.find(item => item.name === name);

            if (product) {
                product.quantity += 1;
            } else {
                cart.push({
                    name,
                    price,
                    image,
                    quantity: 1
                });
            }

            localStorage.setItem("cart", JSON.stringify(cart));
            updateCartCount();
            alert("ƒê√£ th√™m v√†o gi·ªè h√†ng!");
        }

        checkLoginStatus();
        updateCartCount();

        window.addEventListener('load', () => {
            loadProducts();
        });
        // H√†m t√¨m ki·∫øm s·∫£n ph·∫©m
        function searchProducts(event) {
            event.preventDefault(); // NgƒÉn ch·∫∑n form g·ª≠i ƒëi

            const searchQuery = document.getElementById('search-input').value.toLowerCase(); // L·∫•y t·ª´ kh√≥a t√¨m ki·∫øm

            // G·ªôp t·∫•t c·∫£ s·∫£n ph·∫©m t·ª´ c√°c ngu·ªìn d·ªØ li·ªáu
            const allProducts = [
                ...Object.values(dataCf).flat(),
                ...Object.values(dataCom).flat(),
                ...Object.values(dataFan).flat(),
                ...Object.values(dataHutBui).flat()
            ];

            // L·ªçc s·∫£n ph·∫©m theo t√™n
            const filteredProducts = allProducts.filter(product => product.name.toLowerCase().includes(searchQuery));

            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            displayProducts(filteredProducts);
        }

        // H√†m hi·ªÉn th·ªã s·∫£n ph·∫©m
        function displayProducts(products) {
            const container = document.getElementById('product-list');
            let html = "";

            // N·∫øu kh√¥ng c√≥ s·∫£n ph·∫©m n√†o t√¨m th·∫•y
            if (products.length === 0) {
                html = "<p>Kh√¥ng c√≥ s·∫£n ph·∫©m n√†o ph√π h·ª£p v·ªõi t√¨m ki·∫øm c·ªßa b·∫°n.</p>";
            } else {
                // Hi·ªÉn th·ªã c√°c s·∫£n ph·∫©m t√¨m th·∫•y
                products.forEach(p => {
                    html += `
                <div class="col-md-4 mb-4">
                    <div class="card h-100">
                        <img src="${p.img}" class="card-img-top" alt="${p.name}">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">${p.name}</h5>
                            <p class="card-text text-danger fw-bold">${p.price}</p>
                            <button class="btn btn-primary mt-auto" onclick="addToCart('${p.name}', '${p.price}', '${p.img}')">Th√™m v√†o gi·ªè h√†ng</button>
                        </div>
                    </div>
                </div>`;
                });
            }

            container.innerHTML = html;
        }

        // H√†m th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng
        function addToCart(name, price, img) {
            const storedUser = localStorage.getItem("loggedInUser");

            if (!storedUser) {
                alert("B·∫°n c·∫ßn ƒëƒÉng nh·∫≠p ƒë·ªÉ th√™m s·∫£n ph·∫©m v√†o gi·ªè h√†ng!");
                return;
            }

            let cart = JSON.parse(localStorage.getItem("cart")) || [];
            let product = cart.find(item => item.name === name);

            if (product) {
                product.quantity += 1;
            } else {
                cart.push({
                    name,
                    price,
                    img,
                    quantity: 1
                });
            }

            localStorage.setItem("cart", JSON.stringify(cart));
            updateCartCount();
            alert("ƒê√£ th√™m v√†o gi·ªè h√†ng!");
        }

        function showUserInfo() {
            const userData = JSON.parse(localStorage.getItem("loggedInUser"));
            const popup = document.getElementById("user-info-popup");
            const details = document.getElementById("user-details");

            if (!userData.name || !userData.phone || !userData.address) {
                details.innerHTML = `<p>B·∫°n ch∆∞a c·∫≠p nh·∫≠t ƒë·∫ßy ƒë·ªß th√¥ng tin c√° nh√¢n!</p>`;
            } else {
                details.innerHTML = `
            <p><strong>H·ªç t√™n:</strong> ${userData.name}</p>
            <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> ${userData.phone}</p>
            <p><strong>ƒê·ªãa ch·ªâ:</strong> ${userData.address}</p>
        `;
            }

            popup.classList.remove("d-none");
        }

        function closePopup() {
            document.getElementById("user-info-popup").classList.add("d-none");
        }

        function updateUserInfo() {
            const name = prompt("Nh·∫≠p h·ªç t√™n:");
            const phone = prompt("Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i:");
            const address = prompt("Nh·∫≠p ƒë·ªãa ch·ªâ:");

            let userData = JSON.parse(localStorage.getItem("loggedInUser")) || {};
            userData.name = name;
            userData.phone = phone;
            userData.address = address;

            localStorage.setItem("loggedInUser", JSON.stringify(userData));
            alert("ƒê√£ c·∫≠p nh·∫≠t th√¥ng tin c√° nh√¢n!");
            showUserInfo(); // Hi·ªÉn th·ªã l·∫°i th√¥ng tin m·ªõi
        }

        function saveUserInfo(event) {
            event.preventDefault();
            const fullName = document.getElementById("fullName").value;
            const phone = document.getElementById("phone").value;
            const address = document.getElementById("address").value;

            let storedUser = JSON.parse(localStorage.getItem("loggedInUser"));
            storedUser.fullName = fullName;
            storedUser.phone = phone;
            storedUser.address = address;

            localStorage.setItem("loggedInUser", JSON.stringify(storedUser));
            alert("C·∫≠p nh·∫≠t th√¥ng tin th√†nh c√¥ng!");
            showUserInfo(); // C·∫≠p nh·∫≠t l·∫°i box hi·ªÉn th·ªã
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
<footer class="bg-light text-dark py-4">
    <div class="container">
        <div class="row d-flex align-items-center justify-content-between">
            <!-- C·ªôt 1: T·ªïng ƒë√†i h·ªó tr·ª£ -->
            <div class="col-md-2 col-6 mb-3">
                <h6 class="fw-bold">T·ªïng ƒë√†i h·ªó tr·ª£</h6>
                <p><i class="bi bi-telephone-fill text-danger"></i>Tr∆∞·ªùng ƒêH C√¥ng Nghi·ªáp</p>
                <p><strong>B·∫£o h√†nh:</strong> 0842797825</p>
                <p><strong>Chat Zalo</strong> <img src="image/zalo-icon.png" alt="Zalo" width="30"></p>
            </div>

            <!-- C·ªôt 2: H·ªó tr·ª£ kh√°ch h√†ng -->
            <div class="col-md-2 col-4 mb-3">
                <h6 class="fw-bold">H·ªó tr·ª£ kh√°ch h√†ng</h6>
                <ul class="list-unstyled">
                    <li><a href="#">Ch√≠nh s√°ch v√† Quy ƒë·ªãnh</a></li>
                    <li><a href="#">H∆∞·ªõng d·∫´n thanh to√°n</a></li>
                    <li><a href="#">ƒê·ªïi - Tr·∫£ h√†ng h√≥a</a></li>
                    <li><a href="#">Ch√≠nh s√°ch B·∫£o h√†nh</a></li>
                </ul>
            </div>

            <!-- C·ªôt 3: Qu·∫£n l√Ω t√†i kho·∫£n -->
            <div class="col-md-2 col-4 mb-3">
                <h6 class="fw-bold">Qu·∫£n l√Ω t√†i kho·∫£n</h6>
                <ul class="list-unstyled">
                    <li><a href="#">Thay ƒë·ªïi th√¥ng tin</a></li>
                    <li><a href="#">L·∫•y l·∫°i m·∫≠t kh·∫©u</a></li>
                    <li><a href="#">Tra c·ª©u ƒë∆°n h√†ng</a></li>
                    <li><a href="#">Qu·∫£n l√Ω gi·ªè h√†ng</a></li>
                </ul>
            </div>

            <!-- C·ªôt 4: V·ªÅ LTHSHOP.vn -->
            <div class="col-md-2 col-4 mb-3">
                <h6 class="fw-bold">V·ªÅ LTHSHOP.vn</h6>
                <ul class="list-unstyled">
                    <li><a href="#">Gi·ªõi thi·ªáu</a></li>
                    <li><a href="#">Li√™n h·ªá</a></li>
                    <li><a href="#">Tuy·ªÉn d·ª•ng</a></li>
                    <li><a href="#">S∆° ƒë·ªì website</a></li>
                </ul>
            </div>
            <!-- C·ªôt 4: V·ªÅ LTHSHOP.vn -->
            <div class="col-md-2 col-4 mb-3">
                <h6 class="fw-bold">B√†i t·∫≠p l·ªõn m√¥n Web</h6>
                <ul class="list-unstyled">
                    <li>H·ªç v√† t√™n : L√¢m Trung Hi·∫øu</li>
                    <li>MSSV : 21112581</li>
                    <li>Th·∫ßy/c√¥ : ƒê·∫∑ng VƒÉn Thu·∫≠n</li>
                    <li>M√£ l·ªõp : 422000239906</li>
                </ul>
            </div>

            <!-- C·ªôt 5: K·∫øt n·ªëi v·ªõi ch√∫ng t√¥i -->
            <div class="col-md-4 col-2 mb-3">
                <h6 class="fw-bold">K·∫øt n·ªëi v·ªõi ch√∫ng t√¥i</h6>
                <div class="d-flex gap-3">
                    <a href="https://zalo.me/0842797825"><img src="image/zalo-icon.png" alt="Zalo" width="30"> Zalo</a>
                    <a href="https://www.facebook.com/hieuisme12/"><img src="image/facebook-icon.jpg" alt="Facebook" width="20"> Facebook</a>
                </div>
            </div>
        </div>
    </div>
</footer>


</html>
